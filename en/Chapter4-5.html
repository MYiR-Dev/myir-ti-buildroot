
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>4.5 CAN Bus · MYD-AM335X-Linux4.1.18-Development-Guide</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Sunny.Guo">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Chapter4-6.html" />
    
    
    <link rel="prev" href="Chapter4-4.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="http://www.myir-tech.com" target="_blank" class="custom-link">MYiR Technology Ltd.</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
            
        

        

        
            
    
        
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.2" data-path="Chapter1.html">
            
                <a href="Chapter1.html">
            
                    
                    1. Software Resources
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.3" data-path="Chapter2.html">
            
                <a href="Chapter2.html">
            
                    
                    2. Deploy development environment
            
                </a>
            

            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.3.1" data-path="Chapter2-1.html">
            
                <a href="Chapter2-1.html">
            
                    
                    2.1 Install tools
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.3.2" data-path="Chapter2-2.html">
            
                <a href="Chapter2-2.html">
            
                    
                    2.2 Setup GCC Toolchain
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="1.4" data-path="Chapter3.html">
            
                <a href="Chapter3.html">
            
                    
                    3. Bulid System
            
                </a>
            

            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.4.1" data-path="Chapter3-1.html">
            
                <a href="Chapter3-1.html">
            
                    
                    3.1 Bulid Bootloader
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.4.2" data-path="Chapter3-2.html">
            
                <a href="Chapter3-2.html">
            
                    
                    3.2 Build Linux Kernel
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.4.3" data-path="Chapter3-3.html">
            
                <a href="Chapter3-3.html">
            
                    
                    3.3 Build Filesystem
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.4.4" data-path="Chapter3-4.html">
            
                <a href="Chapter3-4.html">
            
                    
                    3.4 Build QT
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="1.5" data-path="Chapter4.html">
            
                <a href="Chapter4.html">
            
                    
                    4. Linux Applications Development
            
                </a>
            

            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.5.1" data-path="Chapter4-1.html">
            
                <a href="Chapter4-1.html">
            
                    
                    4.1 LCD
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.5.2" data-path="Chapter4-2.html">
            
                <a href="Chapter4-2.html">
            
                    
                    4.2 Touch Panel
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.5.3" data-path="Chapter4-3.html">
            
                <a href="Chapter4-3.html">
            
                    
                    4.3 RTC
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.5.4" data-path="Chapter4-4.html">
            
                <a href="Chapter4-4.html">
            
                    
                    4.4 RS485
            
                </a>
            

            
        </li>
    
        
        <li class="chapter active" data-level="1.5.5" data-path="Chapter4-5.html">
            
                <a href="Chapter4-5.html">
            
                    
                    4.5 CAN Bus
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.5.6" data-path="Chapter4-6.html">
            
                <a href="Chapter4-6.html">
            
                    
                    4.6 Ethernet
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.5.7" data-path="Chapter4-7.html">
            
                <a href="Chapter4-7.html">
            
                    
                    4.7 NAND Flash
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.5.8" data-path="Chapter4-8.html">
            
                <a href="Chapter4-8.html">
            
                    
                    4.8 KeyPad
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.5.9" data-path="Chapter4-9.html">
            
                <a href="Chapter4-9.html">
            
                    
                    4.9 GPIO-LED
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.5.10" data-path="Chapter4-10.html">
            
                <a href="Chapter4-10.html">
            
                    
                    4.10 Audio
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.5.11" data-path="Chapter4-11.html">
            
                <a href="Chapter4-11.html">
            
                    
                    4.11 USB Host
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.5.12" data-path="Chapter4-12.html">
            
                <a href="Chapter4-12.html">
            
                    
                    4.12 USB Device
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="1.6" data-path="Chapter5.html">
            
                <a href="Chapter5.html">
            
                    
                    5. Qt Applications Development
            
                </a>
            

            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.6.1" data-path="Chapter5-1.html">
            
                <a href="Chapter5-1.html">
            
                    
                    5.1 Install QtCreator
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.6.2" data-path="Chapter5-2.html">
            
                <a href="Chapter5-2.html">
            
                    
                    5.2 Config QtCreator
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.6.3" data-path="Chapter5-3.html">
            
                <a href="Chapter5-3.html">
            
                    
                    5.3 Build QT Application
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="1.7" data-path="Chapter6.html">
            
                <a href="Chapter6.html">
            
                    
                    6. Update System
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.8" data-path="Chapter7.html">
            
                <a href="Chapter7.html">
            
                    
                    7. Peripheral Module Use
            
                </a>
            

            
            <ul class="articles">
                
    
        
        <li class="chapter " data-level="1.8.1" data-path="Chapter7-1.html">
            
                <a href="Chapter7-1.html">
            
                    
                    7.1 4.3-Inch Resistive Touch Screen
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.8.2" data-path="Chapter7-2.html">
            
                <a href="Chapter7-2.html">
            
                    
                    7.2 WIFI Module
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.8.3" data-path="Chapter7-3.html">
            
                <a href="Chapter7-3.html">
            
                    
                    7.3 USB Camera Module
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.8.4" data-path="Chapter7-4.html">
            
                <a href="Chapter7-4.html">
            
                    
                    7.4 GPS Module
            
                </a>
            

            
        </li>
    
        
        <li class="chapter " data-level="1.8.5" data-path="Chapter7-5.html">
            
                <a href="Chapter7-5.html">
            
                    
                    7.5 GPRS Module
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        
        <li class="chapter " data-level="1.9" data-path="appendix.html">
            
                <a href="appendix.html">
            
                    
                    Appendix Warranty & Technical Support Services
            
                </a>
            

            
        </li>
    

        
    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >4.5 CAN Bus</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h2 id="45-can-bus">4.5 CAN Bus</h2>
<p>This example demonstrates the MYD-AM335X series of the same type of two development board how to use Linux APIs to send and receive data from CAN bus, please refer to the source code for detail.</p>
<p><strong>Hardware Preparation: </strong></p>
<ul>
<li>Hardware debugging environment to see chapter second.</li>
</ul>
<table>
<thead>
<tr>
<th>Board Type</th>
<th>MYD-AM335X</th>
<th>MYD-AM335X-Y</th>
<th>MYD-AM335X-J</th>
</tr>
</thead>
<tbody>
<tr>
<td>CAN interface</td>
<td>U16 7,8 Pin were connected to the same type of development board 7,8 Pin</td>
<td>CON2 1,2 Pin were connected to the same type of development board 1,2 Pin</td>
<td>Disconnect jumper cap JP7,Shorted JP4, J17 1,2 Pin were connected to the same type of development board 1,2 Pin</td>
</tr>
</tbody>
</table>
<p><strong>Software Preparation: </strong></p>
<ul>
<li>Linux Kernel 4.1.18</li>
<li>can_test application</li>
<li>ip link applicatoin</li>
</ul>
<table>
<thead>
<tr>
<th>Board Type</th>
<th>MYD-AM335X</th>
<th>MYD-AM335X-Y</th>
<th>MYD-AM335X-J</th>
</tr>
</thead>
<tbody>
<tr>
<td>Operation node</td>
<td>can1</td>
<td>can1</td>
<td>can0</td>
</tr>
</tbody>
</table>
<p><strong>Test Steps:</strong></p>
<ul>
<li>Copy cross compiled <code>&lt;WORKDIR&gt;/Examples/can/can_test</code> to <code>/usr/bin</code> directory of the MYD-AM335x series development board, run <code>can_test</code> application as below:</li>
</ul>
<pre><code># can_test --help
Usage: can_test [options]

Version 1.0
Options:
-d | --device name   can device name: can0
-b | --baudrate baudrate   set baudrate, default baudrate:50000
-l | --loop              operate circularly, default not operate circularly!
-w | --write  frame     frame string with format ID#MESSAGE. such as: 123#112233445566
-h | --help                Print this message
</code></pre><pre><code># ip link set can1 down
# ip link set can1 type can bitrate 50000 triple-sampling on
# ip link set can1 up
</code></pre><ul>
<li>The previous processes are no need to be executed manually. During running <code>can_test</code>, it will be set automatically.
One board is used as sender, the other is used as receiver, they communicate with can_test application as below:</li>
</ul>
<pre><code># chmod 777 /usr/bin/can_test
# can_test -d can0 -w 123#112233445566
[ 5783.823623] c_can_platform 481cc000.can can0: setting BTR=1c1d BRPE=0000
[ 5786.888723] can: controller area network core (rev 20120528 abi 9)
[ 5786.895565] NET: Registered protocol family 29
[ 5786.952090] can: raw protocol (rev 20120528)
====== write  frame: ======
 frame_id = 0x123
 frame_len = 6
 frame_data = 0x11 0x22 0x33 0x44 0x55 0x66
===========================
</code></pre><ul>
<li>Execute the following command at other board to receive data as below:</li>
</ul>
<pre><code># chmod 777 /usr/bin/can_test
# can_test -d can1 -l
[ 5888.821956] c_can_platform 481d0000.can can1: setting BTR=1c1d BRPE=0000
[ 5891.884726] can: controller area network core (rev 20120528 abi 9)
[ 5891.898711] NET: Registered protocol family 29
[ 5891.952878] can: raw protocol (rev 20120528)
can1 0x123 [6] 0x11 0x22 0x33 0x44 0x55 0x66
</code></pre><ul>
<li>-l option is used for operating circularly.</li>
</ul>
<blockquote>
<p>Note: In case of the following error, please modify the value of &quot;tx_queue_len&quot; as below:</p>
</blockquote>
<pre><code># can_test -d can0 -w 123#112233445566
  can raw socket write: No buffer space available

# echo 1000 &gt; /sys/class/net/can0/tx_queue_len
</code></pre><ul>
<li>Exchange roles of the two boards, the result is the same.</li>
</ul>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Chapter4-4.html" class="navigation navigation-prev " aria-label="Previous page: 4.4 RS485">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Chapter4-6.html" class="navigation navigation-next " aria-label="Next page: 4.6 Ethernet">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"4.5 CAN Bus","level":"1.5.5","depth":2,"next":{"title":"4.6 Ethernet","level":"1.5.6","depth":2,"path":"Chapter4-6.md","ref":"Chapter4-6.md","articles":[]},"previous":{"title":"4.4 RS485","level":"1.5.4","depth":2,"path":"Chapter4-4.md","ref":"Chapter4-4.md","articles":[]},"dir":"ltr"},"config":{"tbfed-pagefooter":{"copyright":"Copyright@MYIR Tech Limited 2011-2017 all rights reserved.","modify_label":"���ļ��޶�ʱ�䣺","modify_format":"YYYY-MM-DD HH:mm:ss"},"plugins":["theme-pdftoc"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"fontSettings":{"size":2},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-pdftoc":{"showLevel":false,"styles":{"ebook":"styles/ebook.css","epub":"styles/epub.css","mobi":"styles/mobi.css","pdf":"styles/pdf.css","print":"styles/print.css","website":"styles/website.css"}},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"Sunny.Guo","pdf":{"pageNumbers":true,"fontSize":16,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"MYD-AM335X-Linux4.1.18-Development-Guide","language":"en","links":{"sidebar":{"MYiR Technology Ltd.":"http://www.myir-tech.com"}},"gitbook":"3.x.x"},"file":{"path":"Chapter4-5.md","mtime":"2018-04-11T02:39:56.650Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2021-11-22T06:48:48.920Z"},"basePath":".","book":{"language":"en"}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

